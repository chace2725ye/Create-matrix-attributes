# Create-matrix-attributes
Local $hIA = _GDIPlus_ImageAttributesCreate() ;- Create matrix attributes and apply negative colors     Local $tColorMatrix = _GDIPlus_ColorMatrixCreateNegative()         _GDIPlus_ImageAttributesSetColorMatrix($hIA,0,True,$tColorMatrix)       Local $hHBmp = _ScreenCapture_CaptureWnd($sEmpty,$WinHandle,$PosX + 4,$PosY + ($TitleBarHeight/2) + 101,$PosX + $I_SystemBoxX - 20,$PosY + $I_SystemBoxY + ($TitleBarHeight/2) - 15)         Local $hBitmap = _GDIPlus_BitmapCreateFromHBITMAP($hHBmp) ;- Capture the image and transform it into a GDI+ bitmap             Local $hBitmap_Size = _GDIPlus_ImageGetDimension($hBitmap)       Local $hClone = _GDIPlus_BitmapCloneArea($hBitmap,0,0,$hBitmap_Size[0],$hBitmap_Size[1],$GDIP_PXF08INDEXED) ;- Grayscale         _WinAPI_DeleteObject($hHBmp) ;- Convert the colors to 8 Bit         _GDIPlus_BitmapDispose($hBitmap)       Local $hGraphics = _GDIPlus_ImageGetGraphicsContext($hClone)         _GDIPlus_GraphicsDrawImageRectRect($hGraphics,$hClone,0,0,$hBitmap_Size[0],$hBitmap_Size[1],0,0,$hBitmap_Size[0],$hBitmap_Size[1],$hIA)             _GDIPlus_ImageAttributesDispose($hIA) ;- Create inverted image       Local $hBitmap_Scaled = _GDIPlus_ImageScale($hClone,$UpscaleRate,$UpscaleRate,$GDIP_INTERPOLATIONMODE_NEARESTNEIGHBOR)         _GDIPlus_ImageDispose($hClone) ;- Up-scale the image       _GDIPlus_ImageSaveToFile($hBitmap_Scaled,$TempScreenshotPath)         _GDIPlus_BitmapDispose($hBitmap_Scaled) ;- Save the image         _GDIPlus_GraphicsDispose($hGraphics)
